

# üõ†Ô∏è High Level Design
![Screenshot 2024-08-02 122824](https://github.com/user-attachments/assets/26f7e20a-773f-4907-a274-400195f6f520)

https://github.com/pawanpk87/MyRoom/assets/87040096/ad4b4ebe-26a0-4051-b3dc-e6080c69d7d5

<!-- Screenshots -->

### :camera: Screenshots(MyRoom dashboard)
<img width="1511" alt="Screenshot 2024-02-27 at 11 49 04‚ÄØAM" src="https://github.com/pawanpk87/MyRoom/assets/87040096/375a3071-8442-41c1-8a00-2a71d588a1c7">
<img width="1511" alt="Screenshot 2024-02-28 at 10 01 13‚ÄØAM" src="https://github.com/pawanpk87/MyRoom/assets/87040096/a61b1b8f-6094-4a22-9575-ed62245530db">
<img width="1511" alt="Screenshot 2024-02-28 at 10 01 27‚ÄØAM" src="https://github.com/pawanpk87/MyRoom/assets/87040096/4f2f425d-1066-45ec-a559-c5ef49adab63">

### :camera: Screenshots(MyRoom client)
<img width="1511" alt="Screenshot 2024-02-28 at 10 03 28‚ÄØAM" src="https://github.com/pawanpk87/MyRoom/assets/87040096/26c4a823-de24-4b9d-87d7-1a60cfe49fe1">
<img width="1511" alt="Screenshot 2024-02-28 at 10 03 52‚ÄØAM" src="https://github.com/pawanpk87/MyRoom/assets/87040096/86d495ef-3f3e-4fd4-b066-8ed29ae8b80c">
<img width="1511" alt="Screenshot 2024-02-28 at 10 04 53‚ÄØAM" src="https://github.com/pawanpk87/MyRoom/assets/87040096/f29d2314-1a1d-4dab-8b3d-168db1d5a7a6">


### :space_invader: Tech Stack

<div align="center">
    <table>
        <tr>
            <td>Spring Boot<img width="40" src="https://user-images.githubusercontent.com/25181517/183891303-41f257f8-6b3d-487c-aa56-c497b880d0fb.png" alt="Spring Boot" title="Spring Boot"/></td>
            <td>Node.js<img width="40" src="https://user-images.githubusercontent.com/25181517/183568594-85e280a7-0d7e-4d1a-9028-c8c2209e073c.png" alt="Node.js" title="Node.js"/></td>
            <td>Express<img width="40" src="https://user-images.githubusercontent.com/25181517/183859966-a3462d8d-1bc7-4880-b353-e2cbed900ed6.png" alt="Express" title="Express"/></td>
            <td>React<img width="40" src="https://user-images.githubusercontent.com/25181517/183897015-94a058a6-b86e-4e42-a37f-bf92061753e5.png" alt="React" title="React"/></td>
            <td>Next.js<img width="40" src="https://github.com/marwin1991/profile-technology-icons/assets/136815194/5f8c622c-c217-4649-b0a9-7e0ee24bd704" alt="Next.js" title="Next.js"/></td>
            <td>Firebase<img width="40" src="https://user-images.githubusercontent.com/25181517/189716855-2c69ca7a-5149-4647-936d-780610911353.png" alt="Firebase" title="Firebase"/></td>
            <td>TypeScript<img width="40" src="https://user-images.githubusercontent.com/25181517/183890598-19a0ac2d-e88a-4005-a8df-1ee36782fde1.png" alt="TypeScript" title="TypeScript"/></td>
        </tr>
        <tr>
            <td>MySQL<img width="40" src="https://user-images.githubusercontent.com/25181517/183896128-ec99105a-ec1a-4d85-b08b-1aa1620b2046.png" alt="MySQL" title="MySQL"/></td>
            <td>MongoDB<img width="40" src="https://user-images.githubusercontent.com/25181517/182884177-d48a8579-2cd0-447a-b9a6-ffc7cb02560e.png" alt="mongoDB" title="mongoDB"/></td>
            <td>Kafka<img width="40" src="https://user-images.githubusercontent.com/25181517/192107004-2d2fff80-d207-4916-8a3e-130fee5ee495.png" alt="kafka" title="kafka"/></td>
            <td>Swagger<img width="40" src="https://user-images.githubusercontent.com/25181517/186711335-a3729606-5a78-4496-9a36-06efcc74f800.png" alt="Swagger" title="Swagger"/></td>
        </tr>
    </table>
</div>
# MYROOM - H·ªÜ TH·ªêNG QU·∫¢N L√ù KH√ÅCH S·∫†N

## T·ªïng Quan

MyRoom l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω kh√°ch s·∫°n, ƒë∆∞·ª£c x√¢y d·ª±ng theo ki·∫øn tr√∫c microservice. D·ª± √°n n√†y cung c·∫•p m·ªôt n·ªÅn t·∫£ng linh ho·∫°t, c√≥ kh·∫£ nƒÉng m·ªü r·ªông ƒë·ªÉ x·ª≠ l√Ω c√°c nghi·ªáp v·ª• c·ªët l√µi c·ªßa vi·ªác qu·∫£n l√Ω v√† ƒë·∫∑t ph√≤ng kh√°ch s·∫°n, t·ª´ vi·ªác t√¨m ki·∫øm, thanh to√°n ƒë·∫øn qu·∫£n l√Ω sau khi ƒë·∫∑t ph√≤ng.

## M·ª•c ti√™u c·∫£i ti·∫øn
M·ª•c ti√™u c·ªßa vi·ªác c·∫£i ti·∫øn MyRoom l√† x√¢y d·ª±ng m·ªôt h·ªá th·ªëng c√≥ kh·∫£ nƒÉng ch·ªãu t·∫£i cao, ph·∫£n h·ªìi nhanh v√† d·ªÖ b·∫£o tr√¨, t√°ch bi·ªát c√°c ch·ª©c nƒÉng nghi·ªáp v·ª• ph·ª©c t·∫°p th√†nh c√°c d·ªãch v·ª• ƒë·ªôc l·∫≠p.

## C√°c c·∫£i ti·∫øn ƒë√£ th·ª±c hi·ªán

### Rate Limiting

ƒê·ªÉ n√¢ng cao t√≠nh ·ªïn ƒë·ªãnh, b·∫£o m·∫≠t v√† kh·∫£ nƒÉng ph·ª•c h·ªìi c·ªßa h·ªá th·ªëng microservice MyRoom, m·ªôt c∆° ch·∫ø gi·ªõi h·∫°n y√™u c·∫ßu Rate Limiting ƒë√£ ƒë∆∞·ª£c thi·∫øt k·∫ø v√† tri·ªÉn khai. Gi·∫£i ph√°p n√†y s·ª≠ d·ª•ng Spring Cloud Gateway (myroom-gateway) l√†m c·ªïng ki·ªÉm so√°t duy nh·∫•t, t√≠ch h·ª£p v·ªõi Redis ƒë·ªÉ qu·∫£n l√Ω tr·∫°ng th√°i gi·ªõi h·∫°n m·ªôt c√°ch nh·∫•t qu√°n.

### Scalability

Em ƒë√£ t·∫°o th√™m nhi·ªÅu instance cho c√°c service, cho h·ªá th·ªëng microservice hi·ªán t·∫°i nh·∫±m ƒë·∫°t ƒë∆∞·ª£c hai m·ª•c ti√™u ch√≠nh:
- T√≠nh S·∫µn s√†ng cao (High Availability): ƒê·∫£m b·∫£o h·ªá th·ªëng kh√¥ng b·ªã gi√°n ƒëo·∫°n hay s·∫≠p khi m·ªôt service ƒë∆°n l·∫ª g·∫∑p l·ªói.
- M·ªü r·ªông Hi·ªáu nƒÉng (Performance Scaling): Ph√¢n b·ªï t·∫£i (load balancing) cho c√°c service c√≥ l∆∞u l∆∞·ª£ng truy c·∫≠p cao.

### Load balance

H·ªá th·ªëng MyRoom s·ª≠ d·ª•ng c∆° ch·∫ø c√¢n b·∫±ng t·∫£i v·ªõi thu·∫≠t to√°n Round Robin ƒë∆∞·ª£c t√≠ch h·ª£p s·∫µn th√¥ng qua s·ª± k·∫øt h·ª£p c·ªßa hai th√†nh ph·∫ßn c·ªët l√µi: Spring Cloud Gateway (ƒë√≥ng vai tr√≤ API Gateway) v√† Netflix Eureka (ƒë√≥ng vai tr√≤ Service Discovery)

### Retry topic v√† Dead Letter Queue topic

H·ªá th·ªëng MyRoom s·ª≠ d·ª•ng Kafka ƒë·ªÉ li√™n l·∫°c b·∫•t ƒë·ªìng b·ªô gi·ªØa c√°c service. Tuy nhi√™n, ·ªü c·∫•u h√¨nh ban ƒë·∫ßu, n·∫øu m·ªôt service "ti√™u th·ª•" (consumer) g·∫∑p l·ªói khi x·ª≠ l√Ω tin nh·∫Øn (v√≠ d·ª•: mail-service kh√¥ng g·ª≠i ƒë∆∞·ª£c email do SMTP server t·∫°m th·ªùi b·ªã s·∫≠p), tin nh·∫Øn ƒë√≥ s·∫Ω b·ªã b·ªè qua v√† m·∫•t vƒ©nh vi·ªÖn.
ƒê·ªÉ gi·∫£i quy·∫øt r·ªßi ro n√†y, ch√∫ng t√¥i ƒë√£ tri·ªÉn khai m·ªôt c∆° ch·∫ø x·ª≠ l√Ω l·ªói m·∫°nh m·∫Ω bao g·ªìm hai ph·∫ßn: C∆° ch·∫ø Retry v√† Dead Letter Queue.

### Distributed Transaction - SAGA pattern
Saga Pattern ƒë∆∞·ª£c √°p d·ª•ng ƒë·ªÉ gi·∫£i quy·∫øt ch√≠nh x√°c v·∫•n ƒë·ªÅ t√≠nh nh·∫•t qu√°n. N√≥ l√† m·ªôt c∆° ch·∫ø ƒë·ªÉ qu·∫£n l√Ω t√≠nh nh·∫•t qu√°n c·ªßa d·ªØ li·ªáu qua nhi·ªÅu service m√† kh√¥ng c·∫ßn blocking giao d·ªãch. M·ªôt Saga ƒë·∫£m b·∫£o r·∫±ng m·ªôt chu·ªói nghi·ªáp v·ª• ho·∫∑c l√† th√†nh c√¥ng tr·ªçn v·∫πn (Happy Path), ho·∫∑c l√† quay lui tr·ªçn v·∫πn (Sad Path).

### Circuit Breaker

Trong ki·∫øn tr√∫c Microservices c·ªßa d·ª± √°n MyRoom, c√°c services li√™n t·ª•c giao ti·∫øp v·ªõi nhau th√¥ng qua m·∫°ng. ƒêi·ªÅu n√†y ti·ªÅm ·∫©n r·ªßi ro l·ªõn v·ªÅ Cascading Failures:
- Ph·ª• thu·ªôc n·ªôi b·ªô: MyRoom Gateway g·ªçi xu·ªëng Booking Service, Booking Service l·∫°i g·ªçi sang Payment Service. N·∫øu Payment Service g·∫∑p s·ª± c·ªë (ch·∫øt ho·∫∑c ph·∫£n h·ªìi ch·∫≠m), c√°c Thread t·∫°i Booking Service s·∫Ω b·ªã treo (block) ƒë·ªÉ ch·ªù ƒë·ª£i. Khi t√†i nguy√™n c·∫°n ki·ªát, Booking Service s·∫Ω ch·∫øt theo, k√©o theo Gateway b·ªã t√™ li·ªát.
- Ph·ª• thu·ªôc b√™n th·ª© 3: Payment Service ph·ª• thu·ªôc v√†o API c·ªßa Stripe. N·∫øu m·∫°ng c·ªßa Stripe b·ªã lag ho·∫∑c b·∫£o tr√¨, h·ªá th·ªëng c·ªßa ch√∫ng ta kh√¥ng n√™n b·ªã treo theo.
- Tr·∫£i nghi·ªám ng∆∞·ªùi d√πng (UX): Khi h·ªá th·ªëng l·ªói, ng∆∞·ªùi d√πng th∆∞·ªùng ph·∫£i ch·ªù r·∫•t l√¢u (timeout) m·ªõi nh·∫≠n ƒë∆∞·ª£c th√¥ng b√°o l·ªói 500 kh√≥ hi·ªÉu ho·∫∑c m√†n h√¨nh tr·∫Øng x√≥a.

V√¨ v·∫≠y h·ªá th·ªëng c·∫ßn c∆° ch·∫ø ng·∫Øt m·∫°ch ƒë·ªÉ ngƒÉn ch·∫∑n l·ªói lan truy·ªÅn v√† t·ª± ph·ª•c h·ªìi khi d·ªãch v·ª• ·ªïn ƒë·ªãnh tr·ªü l·∫°i.


### Zipkin (Distributed Tracing)
Trong Microservices, m·ªôt h√†nh ƒë·ªông c·ªßa ng∆∞·ªùi d√πng (v√≠ d·ª•: "ƒê·∫∑t ph√≤ng") kh√¥ng ch·ªâ ƒë∆∞·ª£c x·ª≠ l√Ω b·ªüi m·ªôt server, m√† n√≥ nh·∫£y qua r·∫•t nhi·ªÅu n∆°i. N·∫øu kh√¥ng c√≥ Zipkin, logs c·ªßa c√°c service n√†y n·∫±m r·ªùi r·∫°c. Ch√∫ng ta s·∫Ω kh√¥ng bi·∫øt d√≤ng log n√†y ·ªü Booking Service c√≥ li√™n quan g√¨ ƒë·∫øn d√≤ng log kia ·ªü Payment Service. Ngo√†i ra Zipkin c√≤n gi√∫p ch√∫ng ta ph√°t hi·ªán bottleneck.

### ELK (Elasticsearch - Logstash - Kibana)


### Cache data

### Health enpoint monitoring


### Prometheus v√† Grafana




### Distributed lock

### Pipe and filter



### Competing consumer









